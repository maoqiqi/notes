# ViewModel

ViewModel类旨在以生命周期有意识的方式存储和管理用户界面相关的数据。ViewModel类允许数据在配置更改(如屏幕旋转)之后存活。


## 目录

* [概述](#概述)
* [实现ViewModel](#实现ViewModel)
* [ViewModel的生命周期](#ViewModel的生命周期)
* [在片段之间共享数据](#在片段之间共享数据)
* [用ViewModel替换加载器]
* [更多的信息](#更多的信息)


## 概述

Android框架管理UI控制器的生命周期，例如活动和片段。框架可以决定销毁或重新创建UI控制器以响应某些完全不受您控制的用户操作或设备事件。

如果系统销毁或重新创建UI控制器，则存储在其中的任何瞬态UI相关数据都将丢失。例如，您的应用可能会在其中一项活动中包含用户列表。为配置更改重新创建活动时，新活动必须重新获取用户列表。
对于简单的数据，该活动可以使用onSaveInstanceState()方法，并从onCreate()中的bundle中恢复其数据，
但此方法仅适用于可以序列化然后反序列化的少量数据，而不适用于潜在的大量数据，如用户列表或位图。

另一个问题是UI控制器经常需要进行可能需要一些时间才能返回的异步调用。UI控制器需要管理这些调用并确保系统在销毁后清理它们以避免潜在的内存泄漏。
此管理需要大量维护，并且在为配置更改重新创建对象的情况下，由于对象可能必须重新发出已经进行的调用，因此浪费资源。

活动和片段等UI控制器主要用于显示UI数据、响应用户操作或处理操作系统通信(如权限请求)。要求UI控制器也负责从数据库或网络加载数据，会使类膨胀。
将过多的责任分配给UI控制器可能导致一个类试图独自处理应用程序的所有工作，而不是将工作委托给其他类。以这种方式将过多的责任分配给UI控制器也会使测试变得更加困难。

将视图数据所有权从UI控制器逻辑中分离出来更容易也更有效。


## 实现ViewModel

## ViewModel的生命周期

## 在片段之间共享数据

## 用ViewModel替换加载器

## 更多的信息